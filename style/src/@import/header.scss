/* Header
--------------------------------------------------------------------------------------------*/

@import "./config";

// サブメニュー内子要素1段あたりの個数(横幅固定のため)
$menu-list-count-mold: 5;
$menu-list-count-sand-casting: 3;
$menu-list-count-investment-casting: 3;
$menu-list-count-jewelry: 3;
$menu-list-count-new-field: 4;
$menu-sp-gap-y: 50%; // SPでのヘッダー内のcontent部分の上下余白

.header {
  background: #fff;
  height: $header-height-pc;
  position: fixed;
  top: 0;
  width: 100%;
  z-index: 99;
  @media (max-width: $sp) {
    height: $header-height-sp;
  }

  &__inner {
    display: flex;
    height: 100%;
    position: relative;
  }

  &__logo {
    height: 100%;

    .logo {
      display: block;
      height: 100%;
      padding-left: 40px;
      padding-top: 15px;
      @media (max-width: $pc) {
        padding-left: px-to-vw(25);
      }
      @media (max-width: $sp) {
        padding-left: px-to-vw(10);
        padding-top: 0;
      }
      a {
        display: flex;
        height: $header-logo-height-pc;
        margin-bottom: auto;
        @media (max-width: $pc) {
          height: px-to-vw(65); // = $header-logo-height
        }
        @media (max-width: $sp) {
          height: 100%;
        }
        img {
          @media (max-width: $sp) {
            height: calc(100% / 2);
            margin: auto;
          }
        }
      }
    }
  }

  // ロゴに対しての右側
  &__menu {
    display: flex;
    flex-grow: 1;
    justify-content: flex-end;

    // 問い合わせボタンに対しての左側
    .header__content {
      // ハンバーガー右に隠しておく(クリックで表示)
      @media (max-width: $sp) {
        background: #111;
        height: calc(100vh - #{$header-height-sp});
        left: 100%;
        opacity: 0;
        overflow-y: scroll;
        position: absolute;
        top: $header-height-sp;
        transition: all 0.3s;
        width: 100%;
        will-change: opacity, transform;

        &.js-active {
          opacity: 1;
          transform: translateX(-100%);
        }
      }

      .header__lang {
        align-items: center;
        display: flex;
        height: $header-logo-height-pc;
        justify-content: flex-end;
        .select {
          color: #96a8be;
          display: inline-block;
        }
        // 検索フォーム
        .search-form {
          max-width: 260px;
          position: relative;

          &__input {
            background: $c-whitesmoke;
            border: none;
            font-size: 12px;
            line-height: 1;
            padding: 0.5em 2em 0.5em 1em;
          }

          &__button {
            background: $c-whitesmoke;
            bottom: 0;
            margin: auto;
            padding: 3px;
            position: absolute;
            right: 0;
            top: 0;

            svg {
              height: 15px;
              width: 15px;
              .search-icon {
                stroke: $c-gray;
              }
            }
          }
        }

        @media (max-width: $sp) {
          display: flex;
          flex-wrap: wrap;
          margin: 40px auto 0;
          text-align: center;
          width: 90%;
          .select {
            width: 100%;
          }
          .search {
            width: 100%;
          }
        }
      } // header__lang

      // メニューリスト
      .header__list {
        list-style: none;

        & > li {
          display: inline-block;
          @media (max-width: $sp) {
            display: block;
          }
          // 各メニューの左余白
          &:not(:first-child) {
            margin-left: 20px;
            @media (max-width: $pc) {
              margin-left: px-to-vw(20);
            }
            @media (max-width: $sp) {
              margin-left: 0;
              margin-top: 20px;
              padding-top: 20px;
              position: relative;
              &::before {
                background: rgba(255, 255, 255, 0.2);
                content: "";
                display: inline-block;
                height: 1px;
                left: -5%; // header__list余白分
                position: absolute;
                top: 0;
                width: 100vw;
              }
            }
          }
          // 各メニュー下階層の一列の個数
          @media (min-width: $tab) {
            &:nth-of-type(1) {
              .sub .container > ul > li {
                width: calc((100% / #{$menu-list-count-mold}) - 10px);
              }
            }
            &:nth-of-type(2) {
              .sub .container > ul > li {
                width: calc((100% / #{$menu-list-count-sand-casting}) - 10px);
              }
            }
            &:nth-of-type(3) {
              .sub .container > ul > li {
                width: calc((100% / #{$menu-list-count-investment-casting}) - 10px);
              }
            }
            &:nth-of-type(4) {
              .sub .container > ul > li {
                width: calc((100% / #{$menu-list-count-jewelry}) - 10px);
              }
            }
            &:nth-of-type(5) {
              .sub .container > ul > li {
                width: calc((100% / #{$menu-list-count-new-field}) - 10px);
              }
            }
          }
          // 固定ヘッダー第一階層メニュー
          & > a {
            color: #333;
            font-size: 14px;
            font-weight: 700;
            @media (max-width: $pc) {
              font-size: px-to-vw(14);
            }
            @media (min-width: $tab) {
              &:hover {
                color: $c-main;
              }
            }
            @media (max-width: $sp) {
              color: #fff;
              display: block;
              font-size: 14px;
              padding-right: 20px;
              position: relative;

              &::before {
                content: "▲";
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
              }

              &::after {
                color: $c-main;
                content: attr(data-subtitle);
                display: block;
                font-family: "Roboto Condensed", sans-serif;
                font-size: 14px;
                font-weight: 300;
                margin-top: 10px;
              }
            }
          }
          .js-clicked {
            @media (max-width: $sp) {
              &::before {
                transform: translateY(-50%) rotate(180deg);
              }
            }
          }

          // 第二階層以下のメニュー
          .sub {
            @media (min-width: $tab) {
              background: rgb(0, 0, 0);
              height: 0;
              left: 0;
              opacity: 0;
              position: fixed;
              top: $header-height-pc;
              transition: 0.4s all;
              visibility: hidden;
              width: 100%;
              z-index: 99;
            }
            @media (max-width: $sp) {
              top: $header-height-sp;
            }
            .container {
              max-width: 1040px;
              @media (max-width: $sp) {
                margin: 0; //spメニュー内ではcontainerの横余白なし
              }
              & > p {
                font-size: 30px;
                white-space: nowrap;
                @media (max-width: $pc) {
                  font-size: px-to-vw(30);
                  padding-top: px-to-vw(15);
                }
              }
              & > ul {
                display: flex;
                flex-grow: 1;
                flex-wrap: wrap;
                margin-left: 150px;
                @media (max-width: $pc) {
                  margin-left: px-to-vw(150);
                }
                & > li {
                  margin-left: 10px;
                  margin-top: 15px;
                  padding-left: calc(14px / 2);
                  position: relative;
                  &.grow {
                    flex-grow: 1;
                  }
                  &::before {
                    color: $c-main;
                    content: ">";
                    display: inline-block;
                    left: 0;
                    position: absolute;
                  }
                  & > a {
                    color: #fff;
                    font-size: 13px;
                    margin-left: calc(13px / 2);
                    position: relative;
                    @media (max-width: $pc) {
                      font-size: px-to-vw(14);
                      margin-left: px-to-vw(7);
                    }
                  }
                }

                @media (max-width: $sp) {
                  display: block;
                  height: 0;
                  margin-left: 0;
                  opacity: 0;
                  transform: translateY(-30px);
                  transition: all 0.3s;
                  will-change: opacity, height;
                  & > li {
                    margin-top: 20px;
                    padding-left: 0;
                    &::before {
                      display: none;
                    }
                  }

                  &.js-active {
                    height: auto;
                    opacity: 1;
                    transform: none;
                  }
                } // media sp
              }
            }
          } // sub
          &:hover {
            .sub {
              @media (min-width: $tab) {
                height: 200px;
                opacity: 1;
                padding: 50px 0;
                visibility: visible;
              }
            }
          }
        }

        // header__list(sp)
        @media (max-width: $sp) {
          margin: 30px auto 0;
          width: 90%;
        }
      } // header__list
    } // header__content

    // 問い合わせボタン
    .header__button {
      align-items: center;
      background: $c-main;
      display: flex;
      height: 100%;
      justify-content: center;
      margin-left: 50px;
      width: $header-height-pc;
      @media (max-width: $pc) {
        margin-left: 10px;
        width: px-to-vw(100); // = $header-height-pc
      }
      @media (max-width: $sp) {
        margin-left: px-to-vw(10);
        width: $header-height-sp;
      }

      // ハンバーガー(PC非表示)
      &Menu {
        background: #000;
        @extend .header__button;
        margin-left: 0;
        & > div {
          position: relative;
        }
      }

      //
      & > a,
      & > button {
        align-items: center;
        color: #fff;
        display: flex;
        height: 100%; // クリック有効範囲を全体に
        justify-content: center;
        width: 100%; // クリック有効範囲を全体に
        @media (max-width: $sp) {
          font-size: 11px;
          line-height: 1;
          padding: calc((#{$header-height-sp} / 2) / 2) 0; // (コンテンツエリア(ヘッダーの半分) / 2)
        }

        // メールアイコン
        & > div > img {
          margin: 10px auto 0;
          @media (max-width: $sp) {
            height: 15px;
            margin-top: 5px; // トータル height20px
            width: 20px;
          }
        }
        // ハンバーガー棒(~768pxでのみ表示)
        .header__buttonMenu--bar {
          background: #fff;
          display: block;
          height: 2px;
          margin: 6px auto 0;
          transform-origin: center;
          transition: all 0.3s;
          width: 15px;
          will-change: transform, opacity;
          &:nth-of-type(2),
          &:nth-of-type(3) {
            margin-top: 4px;
          }
        }
      }

      & > button.js-menu.js-active {
        .header__buttonMenu--bar {
          &:nth-of-type(1) {
            transform: rotate(-45deg) translateX(-4.5px) translateY(4px);
          }
          &:nth-of-type(2) {
            opacity: 0;
          }
          &:nth-of-type(3) {
            transform: rotate(45deg) translateX(-4px) translateY(-4px);
          }
        }
      }
    }
  }
}

.main {
  margin-top: $header-height-pc;
  @media (max-width: $sp) {
    margin-top: $header-height-sp;
  }
}
